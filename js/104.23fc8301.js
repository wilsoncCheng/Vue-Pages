"use strict";(self["webpackChunkweek6"]=self["webpackChunkweek6"]||[]).push([[104],{2104:function(t,e,l){l.r(e),l.d(e,{default:function(){return yt}});var s=l(6252),o=l(9963),a=l(3577);const i={id:"app"},c={class:"container"},r={class:"row py-3"},d={class:"col-md-6"},n={class:"text-end mt-4"},m={class:"table table-hover mt-4 text-center"},u=(0,s._)("thead",null,[(0,s._)("th",{width:"150"},"分類"),(0,s._)("th",{width:"150"},"產品名稱"),(0,s._)("th",{width:"100"},"原價"),(0,s._)("th",{width:"100"},"售價"),(0,s._)("th",{width:"150"},"是否啟用"),(0,s._)("th",{width:"120"},"編輯")],-1),p={width:"120"},h={width:"150"},b={width:"120"},_={width:"120"},g={width:"150"},w={key:0,class:"text-success"},y={key:1,class:"text-danger"},v={width:"140",class:"d-flex justify-content-between"},f=["onClick"],P=["onClick"],k={class:"col-md-6 mt-4"},U={class:"modal-dialog modal-xl"},x={class:"modal-content border-0"},D={class:"modal-header bg-dark text-white"},$={id:"productModalLabel",class:"modal-title"},C={key:0},V={key:1},z=(0,s._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"close"},null,-1),M={class:"modal-body"},N={class:"row"},A={class:"col-sm-4"},I={class:"mb-3"},j=(0,s._)("label",{for:"imageUrl",class:"form-label"},"主要圖片",-1),H=["src"],K=(0,s._)("h3",{class:"mb-3"},"多圖新增",-1),Y={key:0},L={class:"mb-3"},S=(0,s._)("label",{for:"imageUrl",class:"form-label"},"圖片網址",-1),T=["onUpdate:modelValue"],Z=["src"],q={key:0},B={key:1},E={key:1},F={class:"col-sm-8"},G={class:"mb-3"},J=(0,s._)("label",{for:"title",class:"form-label"},"標題",-1),O={class:"row"},Q={class:"mb-3 col-md-6"},R=(0,s._)("label",{for:"category",class:"form-label"},"類別",-1),W={class:"mb-3 col-md-6"},X=(0,s._)("label",{for:"unit",class:"form-label"},"單位",-1),tt={class:"row"},et={class:"mb-3 col-md-6"},lt=(0,s._)("label",{for:"origin_price",class:"form-label"},"原價",-1),st={class:"mb-3 col-md-6"},ot=(0,s._)("label",{for:"price",class:"form-label"},"售價",-1),at=(0,s._)("hr",null,null,-1),it={class:"mb-3"},ct=(0,s._)("label",{for:"description",class:"form-label"},"產品描述",-1),rt={class:"mb-3"},dt=(0,s._)("label",{for:"content",class:"form-label"},"說明內容",-1),nt={class:"mb-3"},mt={class:"form-check"},ut=(0,s._)("label",{class:"form-check-label",for:"is_enabled"},"是否啟用",-1),pt={class:"modal-footer"},ht=(0,s._)("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function bt(t,e,l,bt,_t,gt){return(0,s.wg)(),(0,s.iD)("div",i,[(0,s._)("form",{onSubmit:e[0]||(e[0]=(0,o.iM)(((...e)=>t.submit&&t.submit(...e)),["prevent"])),class:"vld-parent",ref:"formContainer"},null,544),(0,s._)("div",c,[(0,s._)("div",r,[(0,s._)("div",d,[(0,s._)("div",n,[(0,s._)("button",{type:"button",class:"btn btn-primary",onClick:e[1]||(e[1]=t=>gt.openModal("new"))}," 新增商品資料 ")]),(0,s._)("table",m,[u,(0,s._)("tbody",null,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(_t.products,(t=>((0,s.wg)(),(0,s.iD)("tr",{key:t.id},[(0,s._)("th",p,(0,a.zw)(t.category),1),(0,s._)("th",h,(0,a.zw)(t.title),1),(0,s._)("th",b,(0,a.zw)(t.origin_price),1),(0,s._)("th",_,(0,a.zw)(t.price),1),(0,s._)("th",g,[t.is_enabled?((0,s.wg)(),(0,s.iD)("span",w,"啟用")):((0,s.wg)(),(0,s.iD)("span",y,"關閉"))]),(0,s._)("th",v,[(0,s._)("button",{type:"button",class:"btn btn-outline-primary",onClick:e=>gt.openModal("edit",t)}," 編輯 ",8,f),(0,s._)("button",{type:"button",class:"btn btn-outline-danger",onClick:e=>gt.delProduct(t.id)}," 刪除 ",8,P)])])))),128))])])]),(0,s._)("div",k,[(0,s._)("div",U,[(0,s._)("div",x,[(0,s._)("div",D,[(0,s._)("h5",$,[_t.isNew?((0,s.wg)(),(0,s.iD)("span",C,"新增商品")):((0,s.wg)(),(0,s.iD)("span",V,"編輯商品"))]),z]),(0,s._)("div",M,[(0,s._)("div",N,[(0,s._)("div",A,[(0,s._)("div",I,[j,(0,s.wy)((0,s._)("input",{"onUpdate:modelValue":e[2]||(e[2]=t=>_t.tempProduct.imageUrl=t),type:"text",class:"form-control mb-2",placeholder:"請輸入圖片連結"},null,512),[[o.nr,_t.tempProduct.imageUrl]]),(0,s._)("img",{class:"img-fluid",src:_t.tempProduct.imageUrl},null,8,H)]),K,Array.isArray(_t.tempProduct.imagesUrl)?((0,s.wg)(),(0,s.iD)("div",Y,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(_t.tempProduct.imagesUrl,((t,e)=>((0,s.wg)(),(0,s.iD)("div",{class:"mb-1",key:t},[(0,s._)("div",L,[S,(0,s.wy)((0,s._)("input",{id:"imageUrl","onUpdate:modelValue":t=>_t.tempProduct.imagesUrl[e]=t,type:"text",class:"form-control",placeholder:"請輸入圖片網址"},null,8,T),[[o.nr,_t.tempProduct.imagesUrl[e]]])]),(0,s._)("img",{class:"img-fluid",src:t},null,8,Z)])))),128)),!_t.tempProduct.imagesUrl.length||_t.tempProduct.imagesUrl[_t.tempProduct.imagesUrl.length-1]?((0,s.wg)(),(0,s.iD)("div",q,[(0,s._)("button",{type:"button",class:"btn btn-primary btn-sm w-100",onClick:e[3]||(e[3]=t=>_t.tempProduct.imagesUrl.push(""))},"新增圖片")])):((0,s.wg)(),(0,s.iD)("div",B,[(0,s._)("button",{type:"button",class:"btn btn-danger btn-sm w-100",onClick:e[4]||(e[4]=t=>_t.tempProduct.imagesUrl.pop())},"刪除圖片")]))])):((0,s.wg)(),(0,s.iD)("div",E,[(0,s._)("button",{type:"button",class:"btn btn-outline-primary btn-sm d-block w-100",onClick:e[5]||(e[5]=(...t)=>gt.createImages&&gt.createImages(...t))}," 新增圖片 ")]))]),(0,s._)("div",F,[(0,s._)("div",G,[J,(0,s.wy)((0,s._)("input",{id:"title","onUpdate:modelValue":e[6]||(e[6]=t=>_t.tempProduct.title=t),type:"text",class:"form-control",placeholder:"請輸入標題"},null,512),[[o.nr,_t.tempProduct.title]])]),(0,s._)("div",O,[(0,s._)("div",Q,[R,(0,s.wy)((0,s._)("input",{id:"category","onUpdate:modelValue":e[7]||(e[7]=t=>_t.tempProduct.category=t),class:"form-control",placeholder:"請輸入類別"},null,512),[[o.nr,_t.tempProduct.category]])]),(0,s._)("div",W,[X,(0,s.wy)((0,s._)("input",{id:"unit","onUpdate:modelValue":e[8]||(e[8]=t=>_t.tempProduct.unit=t),class:"form-control",placeholder:"請輸入單位"},null,512),[[o.nr,_t.tempProduct.unit]])])]),(0,s._)("div",tt,[(0,s._)("div",et,[lt,(0,s.wy)((0,s._)("input",{id:"origin_price","onUpdate:modelValue":e[9]||(e[9]=t=>_t.tempProduct.origin_price=t),type:"number",min:"0",class:"form-control",placeholder:"請輸入原價"},null,512),[[o.nr,_t.tempProduct.origin_price,void 0,{number:!0}]])]),(0,s._)("div",st,[ot,(0,s.wy)((0,s._)("input",{id:"price","onUpdate:modelValue":e[10]||(e[10]=t=>_t.tempProduct.price=t),type:"number",min:"0",class:"form-control",placeholder:"請輸入售價"},null,512),[[o.nr,_t.tempProduct.price,void 0,{number:!0}]])])]),at,(0,s._)("div",it,[ct,(0,s.wy)((0,s._)("textarea",{id:"description","onUpdate:modelValue":e[11]||(e[11]=t=>_t.tempProduct.description=t),class:"form-control",type:"text",placeholder:"請輸入產品描述"},null,512),[[o.nr,_t.tempProduct.description]])]),(0,s._)("div",rt,[dt,(0,s.wy)((0,s._)("textarea",{id:"content","onUpdate:modelValue":e[12]||(e[12]=t=>_t.tempProduct.content=t),class:"form-control",type:"text",placeholder:"請輸入說明內容"},null,512),[[o.nr,_t.tempProduct.content]])]),(0,s._)("div",nt,[(0,s._)("div",mt,[(0,s.wy)((0,s._)("input",{id:"is_enabled","onUpdate:modelValue":e[13]||(e[13]=t=>_t.tempProduct.is_enabled=t),type:"checkbox",class:"form-check-input","true-value":1,"false-value":0},null,512),[[o.e8,_t.tempProduct.is_enabled]]),ut])])])])]),(0,s._)("div",pt,[ht,(0,s._)("button",{type:"button",onClick:e[14]||(e[14]=t=>gt.updateProduct()),class:"btn btn-primary","data-bs-dismiss":"modal"}," 確認 ")])])])])])])])}var _t={data(){return{products:[],isNew:!1,tempProduct:{imagesUrl:[]},pagination:{}}},inject:["emitter"],methods:{checkadmin(){const t=this.$loading.show(),e=document.cookie.replace(/(?:(?:^|.*;\s*)hexToken\s*=\s*([^;]*).*$)|^.*$/,"$1");this.$http.defaults.headers.common.Authorization=e;const l="https://vue3-course-api.hexschool.io/v2//api/user/check";this.$http.post(l).then((e=>{this.getProducts(),t.hide()})).catch((t=>{alert(t.data.message),window.location="index.html"}))},getProducts(){this.$http.get("https://vue3-course-api.hexschool.io/v2/api/wilsoncheng/admin/products/all").then((t=>{this.products=t.data.products}))},getData(t=1){const e=`https://vue3-course-api.hexschool.io/v2/api/wilsoncheng/admin/products/?page=${t}`;this.$http.get(e).then((t=>{this.products=t.data.products,this.pagination=t.data.pagination})).catch((t=>{alert(t.data.message)}))},updateProduct(){let t="https://vue3-course-api.hexschool.io/v2/api/wilsoncheng/admin/product",e="post";this.isNew||(t=`https://vue3-course-api.hexschool.io/v2/api/wilsoncheng/admin/product/${this.tempProduct.id}`,e="put"),this.$http[e](t,{data:this.tempProduct}).then((t=>{this.getProducts(),this.emitter.emit("push-message",{style:"success",title:"產品資料已更新"})})).catch((t=>{alert(t.data.message)}))},openModal(t,e){"new"===t?(this.tempProduct={imagesUrl:[]},this.isNew=!0):"edit"===t&&(this.tempProduct={...e},this.isNew=!1)},createImages(){this.tempProduct.imagesUrl=[],this.tempProduct.imagesUrl.push("")},delProduct(t){const e=`https://vue3-course-api.hexschool.io/v2//api/wilsoncheng/admin/product/${t}`;this.$http.delete(e,{data:this.tempProduct}).then((t=>{this.getProducts(),this.emitter.emit("push-message",{style:"danger",title:"產品資料已刪除"})})).catch((t=>{alert(t.response.data.message)}))}},mounted(){this.checkadmin()}},gt=l(3744);const wt=(0,gt.Z)(_t,[["render",bt]]);var yt=wt}}]);
//# sourceMappingURL=104.23fc8301.js.map