"use strict";(self["webpackChunkweek6"]=self["webpackChunkweek6"]||[]).push([[119],{4902:function(e,t,a){var s=a(9391);const l=(0,s.Z)();t["Z"]=l},4600:function(e,t,a){a.d(t,{Z:function(){return v}});var s=a(6252),l=a(3577),i=a(9963);const n={class:"pagination"},r=(0,s._)("span",{"aria-hidden":"true"},"«",-1),o=[r],c={key:0,class:"page-link"},d=["onClick"],u=(0,s._)("span",{"aria-hidden":"true"},"»",-1),m=[u];function p(e,t,a,r,u,p){return(0,s.wg)(),(0,s.iD)("ul",n,[(0,s._)("li",{class:(0,l.C_)(["page-item",{disabled:1===u.pages.current_page}])},[(0,s._)("a",{class:"page-link",href:"#/products","aria-label":"Previous",onClick:t[0]||(t[0]=(0,i.iM)((t=>p.pageChange(e.item-1)),["prevent"]))},o)],2),((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(u.pages.total_pages,((e,t)=>((0,s.wg)(),(0,s.iD)("li",{key:t,class:(0,l.C_)(["page-item",{active:e===u.pages.current_page}])},[e===u.pages.current_page?((0,s.wg)(),(0,s.iD)("span",c,(0,l.zw)(e),1)):((0,s.wg)(),(0,s.iD)("a",{key:1,onClick:(0,i.iM)((t=>p.pageChange(e)),["prevent"]),class:"page-link",href:"#/products"},(0,l.zw)(e),9,d))],2)))),128)),(0,s._)("li",{class:(0,l.C_)(["page-item",{disabled:u.pages.current_page===u.pages.total_pages}])},[(0,s._)("a",{class:"page-link",href:"#/products","aria-label":"Next",onClick:t[1]||(t[1]=(0,i.iM)((t=>p.pageChange(e.item+1)),["prevent"]))},m)],2)])}var g={data(){return{pages:{}}},inject:["emitter"],methods:{pageChange(e){this.emitter.emit("deliver-page_now",{page:e})}},mounted(){this.emitter.on("push-pagination",(e=>{this.pages=e.pages}))}},h=a(3744);const _=(0,h.Z)(g,[["render",p]]);var v=_},3119:function(e,t,a){a.r(t),a.d(t,{default:function(){return R}});var s=a(6252),l=a(9963),i=a(3577);const n={class:"container"},r={class:"row"},o={class:"col-md-12 col-lg-6"},c={class:"mt-4"},d=(0,s._)("h2",null,"購物車",-1),u={class:"text-end"},m={class:"table align-middle"},p=(0,s._)("thead",null,[(0,s._)("tr",null,[(0,s._)("th",null,"圖片"),(0,s._)("th",null,"商品名稱"),(0,s._)("th",null,"價格"),(0,s._)("th")])],-1),g=["onClick"],h={class:"spinner-grow spinner-grow-sm",role:"status"},_=(0,s._)("span",{class:"visually-hidden"},null,-1),v=[_],f=(0,s.Uk)(" x "),w=(0,s._)("div",{class:"text-success"},"已套用優惠券",-1),b={class:"input-group input-group-sm"},k={class:"input-group mb-3"},y=["onUpdate:modelValue","onChange"],C=["value","selected"],x={class:"input-group-text",id:"basic-addon2"},V={class:"text-end"},D={key:1},I={colspan:"3",class:"text-end"},L={class:"text-end"},z=(0,s._)("td",{colspan:"3",class:"text-end text-success"},"折扣價",-1),$={class:"text-end text-success"},q={class:"my-5 row col-md-12 col-lg-6 justify-content-center"},U={class:"mb-3 w-100"},W=(0,s._)("label",{for:"email",class:"form-label"},"Email",-1),O={class:"mb-3 w-100"},Z=(0,s._)("label",{for:"name",class:"form-label"},"收件人姓名",-1),M={class:"mb-3"},H=(0,s._)("label",{for:"tel",class:"form-label"},"收件人電話",-1),Y={class:"mb-3"},j={for:"address",class:"form-label"},K={class:"mb-3"},P=(0,s._)("label",{for:"message",class:"form-label"},"留言",-1),S={class:"text-end"},T={class:"btn btn-danger"},E=(0,s._)("span",{class:"visually-hidden"},null,-1),F=[E];function N(e,t,a,_,E,N){const A=(0,s.up)("Vee-field"),B=(0,s.up)("error-message"),G=(0,s.up)("Vee-form"),J=(0,s.up)("PaginationTool");return(0,s.wg)(),(0,s.iD)(s.HY,null,[(0,s._)("div",n,[(0,s._)("div",r,[(0,s._)("div",o,[(0,s._)("div",c,[d,(0,s._)("div",u,[(0,s._)("button",{class:"btn btn-outline-danger",type:"button",onClick:t[0]||(t[0]=e=>N.removeCarts())},"清空購物車")]),(0,s._)("table",m,[p,(0,s._)("tbody",null,[E.cartData.carts?((0,s.wg)(!0),(0,s.iD)(s.HY,{key:0},(0,s.Ko)(E.cartData.carts,(e=>((0,s.wg)(),(0,s.iD)("tr",{key:e.id},[(0,s._)("td",null,[(0,s._)("button",{type:"button",onClick:t=>N.removeCartItem(e.id),class:"btn btn-outline-danger btn-sm"},[(0,s.wy)((0,s._)("div",h,v,512),[[l.F8,E.isLoadingItem]]),f],8,g)]),(0,s._)("td",null,[(0,s.Uk)((0,i.zw)(e.product.title)+" ",1),w]),(0,s._)("td",null,[(0,s._)("div",b,[(0,s._)("div",k,[(0,s.wy)((0,s._)("select",{id:"",class:"form-select","onUpdate:modelValue":t=>e.qty=t,onChange:t=>N.updateCartItem(e)},[((0,s.wg)(),(0,s.iD)(s.HY,null,(0,s.Ko)(20,(t=>(0,s._)("option",{value:t,selected:e.qty===t,key:`${t}-${e.id}`},(0,i.zw)(t),9,C))),64))],40,y),[[l.bM,e.qty]]),(0,s._)("span",x,(0,i.zw)(e.product.unit),1)])])]),(0,s._)("td",V,(0,i.zw)(e.total),1)])))),128)):((0,s.wg)(),(0,s.iD)("div",D,"123"))]),(0,s._)("tfoot",null,[(0,s._)("tr",null,[(0,s._)("td",I,"總計"+(0,i.zw)(e.isShow),1),(0,s._)("td",L,(0,i.zw)(E.cartData.total),1)]),(0,s._)("tr",null,[z,(0,s._)("td",$,(0,i.zw)(E.cartData.final_total),1)])])])])]),(0,s._)("div",q,[(0,s.Wm)(G,{ref:"form",onSubmit:N.createOrder},{default:(0,s.w5)((({errors:a})=>[(0,s.Uk)((0,i.zw)(e.error)+" ",1),(0,s._)("div",U,[W,(0,s.Wm)(A,{id:"email",name:"email",type:"email",class:(0,i.C_)(["form-control",{"is-invalid":a["email"]}]),placeholder:"請輸入 Email",rules:"email|required",modelValue:E.user.email,"onUpdate:modelValue":t[1]||(t[1]=e=>E.user.email=e)},null,8,["class","modelValue"]),(0,s.Wm)(B,{name:"email",class:"invalid-feedback"})]),(0,s._)("div",O,[Z,(0,s.Wm)(A,{id:"name",name:"姓名",type:"text",class:(0,i.C_)(["form-control",{"is-invalid":a["姓名"]}]),placeholder:"請輸入姓名",rules:"required",modelValue:E.user.name,"onUpdate:modelValue":t[2]||(t[2]=e=>E.user.name=e)},null,8,["class","modelValue"]),(0,s.Wm)(B,{name:"姓名",class:"invalid-feedback"})]),(0,s._)("div",M,[H,(0,s.Wm)(A,{id:"tel",name:"電話",type:"text",class:(0,i.C_)(["form-control",{"is-invalid":a["電話"]}]),placeholder:"請輸入電話",rules:"required|min:8|max:10",modelValue:E.user.tel,"onUpdate:modelValue":t[3]||(t[3]=e=>E.user.tel=e)},null,8,["class","modelValue"]),(0,s.Wm)(B,{name:"電話",class:"invalid-feedback"})]),(0,s._)("div",Y,[(0,s._)("label",j,"收件人地址"+(0,i.zw)(E.user.address),1),(0,s.Wm)(A,{id:"address",name:"地址",type:"text",class:"form-control",placeholder:"請輸入地址",rules:"required",modelValue:E.user.address,"onUpdate:modelValue":t[4]||(t[4]=e=>E.user.address=e)},null,8,["modelValue"]),(0,s.Wm)(B,{name:"地址",class:"invalid-feedback"})]),(0,s._)("div",K,[P,(0,s.wy)((0,s._)("textarea",{name:"",id:"message",class:"form-control",cols:"30",rows:"10","onUpdate:modelValue":t[5]||(t[5]=e=>E.message=e)},null,512),[[l.nr,E.message]])]),(0,s._)("div",S,[(0,s._)("button",T,[(0,s.wy)((0,s._)("a",{onClick:t[6]||(t[6]=e=>N.createOrder()),class:"spinner-grow spinner-grow-sm",role:"status"},F,512),[[l.F8,E.isLoadingOrder]]),(0,s.Uk)("送出"+(0,i.zw)(this.order_id)+"訂單",1)])])])),_:1},8,["onSubmit"])])])]),(0,s.Wm)(J)],64)}var A=a(4600),B=a(4902),G={data(){return{cartData:{},products:[],isLoadingItem:"",isLoadingOrder:"",data:{qty:"",product_id:""},user:{},message:""}},components:{PaginationTool:A.Z},inject:["emitter"],methods:{getcart(){this.$http.get("https://vue3-course-api.hexschool.io/v2/api/wilsoncheng/cart").then((e=>{this.cartData=e.data.data}))},removeCartItem(e){this.isLoadingItem=e,this.$http.delete(`https://vue3-course-api.hexschool.io/v2/api/wilsoncheng/cart/${e}`).then((e=>{this.getcart(),this.isLoadingItem=""}))},removeCarts(){this.isLoadingItem="working",this.$http.delete("https://vue3-course-api.hexschool.io/v2/api/wilsoncheng/carts").then((e=>{this.getcart(),this.isLoadingItem="",this.emitter.emit("push-message",{style:"danger",title:"已刪除此訂單"})}))},addToCart(e,t=1){const a={product_id:e,qty:t};this.isLoadingItem=e,this.$http.post("https://vue3-course-api.hexschool.io/v2/api/wilsoncheng/cart",{data:a}).then((e=>{this.isLoadingItem="",B.Z.emit("get-cart"),this.emitter.emit("push-message",{style:"success",title:"已經加入購物車"}),this.getcart()}))},updateCartItem(e){const t={product_id:e.id,qty:e.qty};this.isLoadingItem=e.id,this.$http.put(`https://vue3-course-api.hexschool.io/v2/api/wilsoncheng/cart/${e.id}`,{data:t}).then((e=>{this.getcart(),this.isLoadingItem=""}))},createOrder(){this.isLoadingOrder="working";const e={user:this.user,message:this.message};this.$http.post("https://vue3-course-api.hexschool.io/v2/api/wilsoncheng/order",{data:e}).then((e=>{this.getcart(),this.emitter.emit("push-message",{style:"success",title:"成功建立訂單"}),this.emitter.emit("push-order",{res:e}),this.$router.push({path:`/payment/${e.data.orderId}`})})),this.isLoadingOrder="",this.user={}}},mounted(){this.getcart()}},J=a(3744);const Q=(0,J.Z)(G,[["render",N]]);var R=Q},9391:function(e,t,a){function s(e){return{all:e=e||new Map,on:function(t,a){var s=e.get(t);s?s.push(a):e.set(t,[a])},off:function(t,a){var s=e.get(t);s&&(a?s.splice(s.indexOf(a)>>>0,1):e.set(t,[]))},emit:function(t,a){var s=e.get(t);s&&s.slice().map((function(e){e(a)})),(s=e.get("*"))&&s.slice().map((function(e){e(t,a)}))}}}a.d(t,{Z:function(){return s}})}}]);
//# sourceMappingURL=119.0edeb876.js.map